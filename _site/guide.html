<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>IS415-Project - User Guide</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">IS415-Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./DataWrangling.html"> 
<span class="menu-text">Data Wrangling</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./poster.html"> 
<span class="menu-text">Poster</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./guide.html" aria-current="page"> 
<span class="menu-text">User Guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://is415-kwee-cheng.shinyapps.io/G1T9-AbangSmith/"> 
<span class="menu-text">Shiny Application</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#navigation-bar" id="toc-navigation-bar" class="nav-link active" data-scroll-target="#navigation-bar">Navigation Bar</a></li>
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda">EDA</a>
  <ul class="collapse">
  <li><a href="#data-set" id="toc-data-set" class="nav-link" data-scroll-target="#data-set">Data Set</a></li>
  <li><a href="#lisa" id="toc-lisa" class="nav-link" data-scroll-target="#lisa">LISA</a></li>
  </ul></li>
  <li><a href="#geographically-weighted-regression" id="toc-geographically-weighted-regression" class="nav-link" data-scroll-target="#geographically-weighted-regression">Geographically Weighted Regression</a>
  <ul class="collapse">
  <li><a href="#assumptions-checks" id="toc-assumptions-checks" class="nav-link" data-scroll-target="#assumptions-checks">Assumptions Checks</a></li>
  <li><a href="#gwr-model" id="toc-gwr-model" class="nav-link" data-scroll-target="#gwr-model">GWR Model</a></li>
  </ul></li>
  <li><a href="#spatial-autocorrelation" id="toc-spatial-autocorrelation" class="nav-link" data-scroll-target="#spatial-autocorrelation">Spatial Autocorrelation</a>
  <ul class="collapse">
  <li><a href="#global-and-local-spatial-autocorrelation" id="toc-global-and-local-spatial-autocorrelation" class="nav-link" data-scroll-target="#global-and-local-spatial-autocorrelation">Global and Local Spatial Autocorrelation</a></li>
  <li><a href="#emerging-hot-spot-analysis" id="toc-emerging-hot-spot-analysis" class="nav-link" data-scroll-target="#emerging-hot-spot-analysis">Emerging Hot Spot Analysis</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">User Guide</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This serves as guide on how to use our <a href="https://is415-kwee-cheng.shinyapps.io/G1T9-AbangSmith/">Shiny application</a></p>
<section id="navigation-bar" class="level2">
<h2 class="anchored" data-anchor-id="navigation-bar">Navigation Bar</h2>
<p><img src="images/clipboard-1207142688.png" class="img-fluid"></p>
<p>This serves as the main point to navigate the different types of analysis that we did</p>
</section>
<section id="eda" class="level2">
<h2 class="anchored" data-anchor-id="eda">EDA</h2>
<section id="data-set" class="level3">
<h3 class="anchored" data-anchor-id="data-set">Data Set</h3>
<p>This tab allows users to visualise the distribution of the different types of crime, including socio-economic factors. They are presented with a histogram (top-left), box-plot (top-right) and a choropleth map at the bottom.</p>
<p><img src="images/clipboard-4053125080.png" class="img-fluid"></p>
<p>Users are able to select the variable they would like to explore whether it be socio-economic factors or the different types of crime. They are also able to specify the year they would like to explore. It should be noted that socio-economic factors like <strong><em>gini, income mean, income median, poverty absolute, poverty relative</em></strong> are only available for the years <strong>2019</strong> &amp; <strong>2022.</strong> As this is what was given on <a href="data.gov.my">data.gov.my</a></p>
</section>
<section id="lisa" class="level3">
<h3 class="anchored" data-anchor-id="lisa">LISA</h3>
<p>In this tab users are able to explore LISA classification for socio-economic factors as those were not covered in the Spatial Autocorrelation.</p>
<p><img src="images/clipboard-1741873807.png" class="img-fluid"></p>
<p>Users are able to select the socio-economic factors that they would like for LISA classification and the type of LISA classification. Likewise socio-economic factors like <strong><em>gini, income mean, income median, poverty absolute, poverty relative</em></strong> are only available for the years <strong>2019</strong> &amp; <strong>2022</strong>.</p>
</section>
</section>
<section id="geographically-weighted-regression" class="level2">
<h2 class="anchored" data-anchor-id="geographically-weighted-regression">Geographically Weighted Regression</h2>
<section id="assumptions-checks" class="level3">
<h3 class="anchored" data-anchor-id="assumptions-checks">Assumptions Checks</h3>
<section id="correlation-analysis" class="level4">
<h4 class="anchored" data-anchor-id="correlation-analysis">Correlation Analysis</h4>
<p>This tab allows users to visualise the correlation between independent variables.</p>
<p><img src="images/image_2024-11-24_17-19-45.png" class="img-fluid"></p>
<p>Users are able to select the socio-economic factors (independent variables) that they would want to compare and the type of crime classification. These socio-economic factors are only available for the years <strong>2019</strong> &amp; <strong>2022</strong>. Users are also able to select the significant level for the correlation matrix.</p>
</section>
<section id="model-performance" class="level4">
<h4 class="anchored" data-anchor-id="model-performance">Model Performance</h4>
<p>This tab assists user to in their decision whether to select stepwise regression models or base model by showing its performance.</p>
<p><img src="images/image_2024-11-24_17-20-13.png" class="img-fluid"></p>
<p>Users are able to select the socio-economic factors (independent variables) that they would want to compare and the type of crime classification. These socio-economic factors are only available for the years <strong>2019</strong> &amp; <strong>2022</strong>. Users are also able to p value for the stepwise regression models.</p>
</section>
<section id="check" class="level4">
<h4 class="anchored" data-anchor-id="check">Check</h4>
<p>This tab assists user to conclude if the assumption checks for geographically weighted regression are met. They are presented with plots/graphs of linearity (top-left), normality check (top-right), outliers (bottom-left), and collinearity (bottom-right).</p>
<p><img src="images/image_2024-11-24_17-20-56.png" class="img-fluid"></p>
</section>
</section>
<section id="gwr-model" class="level3">
<h3 class="anchored" data-anchor-id="gwr-model">GWR Model</h3>
<section id="map" class="level4">
<h4 class="anchored" data-anchor-id="map">Map</h4>
<p><img src="images/image_2024-11-24_15-58-42.png" class="img-fluid"></p>
<p><img src="images/image_2024-11-24_16-01-29.png" class="img-fluid"></p>
<p>This tab allows user to compare the local R-squared with that socio-economic factor of their choosing, based on the type of crime and year. Only the years <strong>2019</strong> &amp; <strong>2022 are available</strong> as missing data will influence GWR.</p>
<p>Users are able to customise the computation function, approach, distancec metric and stepwise regression model.</p>
<p>After plotting the initial map, user are then able to customise what variables they want to compare with the local R-squared (top map) on the second map (bottom map).</p>
</section>
<section id="stats" class="level4">
<h4 class="anchored" data-anchor-id="stats">Stats</h4>
<p><img src="images/image_2024-11-24_16-00-26.png" class="img-fluid"></p>
<p>This tab allows user to view the coefficent estimates and the statistics of the regression model given the parameters selected (identical to the <em>Map</em> tab).</p>
</section>
</section>
</section>
<section id="spatial-autocorrelation" class="level2">
<h2 class="anchored" data-anchor-id="spatial-autocorrelation">Spatial Autocorrelation</h2>
<section id="global-and-local-spatial-autocorrelation" class="level3">
<h3 class="anchored" data-anchor-id="global-and-local-spatial-autocorrelation">Global and Local Spatial Autocorrelation</h3>
<section id="global-spatial-autocorrelation" class="level4">
<h4 class="anchored" data-anchor-id="global-spatial-autocorrelation">Global Spatial Autocorrelation</h4>
<p><img src="images/clipboard-601498860.png" class="img-fluid"></p>
<p><img src="images/clipboard-147141593.png" class="img-fluid"></p>
<p>This tab allows user to view global and local spatial autocorrelation, we decided to combine it into one tab as a few of the inputs are overlapped between global and local. The results are then displayed on the three tabs on the right.</p>
<p><br>
From here users are able to select the type of crime and year which applies for <strong>global and local spatial autocorrelation</strong> and <strong>LISA</strong>.</p>
<p>For choosing which relationship to map to, users are able to choose the socio-economic factor that they would like to show alongside for <strong>Local Spatial Autocorrelation</strong> and <strong>LISA</strong>. Likewise socio-economic factors like <strong><em>gini, income mean, income median, poverty absolute, poverty relative</em></strong> are only available for the years <strong>2019</strong> &amp; <strong>2022</strong>.</p>
<p>Users are able to customise the weight matrix by selecting the contiguity method (Queen or Rook) and the spatial weights style (row standardized), and the number of simulations to run. This affects <strong>Global and Local Autocorrelation</strong> and <strong>LISA</strong></p>
<p>Users are able to select the type of LISA classification and confidence level which only applies for <strong>LISA</strong>. And finally users are able to select the local moran stat which applies only for <strong>Local Spatial Autocorrelation</strong></p>
</section>
<section id="global-spatial-autocorrelation-1" class="level4">
<h4 class="anchored" data-anchor-id="global-spatial-autocorrelation-1">Global Spatial Autocorrelation</h4>
<p>This is an example of the output for Global Spatial Autocorrelation, it shows the Global Moran Test on the top left, and the Monte-Carlo Simulation on the top right which is to double confirm the results of the Global Moran Test. And the histogram on the bottom shows the distribution of the results from the Monte-Carlo Simulation.</p>
<p>Having a positive Moran I statistic suggest that there is clustering, while a negative Moran I statistic suggest spatial dispersion. Also a small p-value of &lt; 0.05 suggest that it might not have happened randomly, while a p-value &gt; 0.05 suggest that it might have occured randomly.</p>
<p><img src="images/clipboard-1196003943.png" class="img-fluid"></p>
</section>
<section id="local-spatial-autocorrelation" class="level4">
<h4 class="anchored" data-anchor-id="local-spatial-autocorrelation">Local Spatial Autocorrelation</h4>
<p>This is an example of the output for Local Spatial Autocorrelation, where it shows the Local Moran Stat that was chosen indicated by the top right indicator, where it is map along side the type of socio-economic factor that was chosen, indicated by the numbers on the map. From here user can make an inference of whether the Local Moran Stat chosen was statistically significant and whether it correlates to the socio-economic factor that was chosen.</p>
<p><img src="images/clipboard-3104429770.png" class="img-fluid"></p>
</section>
<section id="lisa-1" class="level4">
<h4 class="anchored" data-anchor-id="lisa-1">LISA</h4>
<p>An example of the output for LISA where it shows the LISA map based on the type of LISA class that was chosen which is mapped to the socio-economic factor that was chosen.</p>
<ul>
<li><p><strong>High-Low Outliers:</strong> Districts with a high value of the type of crime, surrounded by neighbouring districts with low values of the type of crime.</p></li>
<li><p><strong>Low-High Outliers</strong>: Districts with a low value of the type of crime, surrounded by neighbouring districts with high values of the type of crime.</p></li>
<li><p><strong>High-High Clusters</strong>: Districts with a high value of the type of crime, surrounded by neighbouring Districts with high values of the type of crime.</p></li>
<li><p><strong>Low-Low Clusters</strong>: Districts with a low value of the type of crime, surrounded by neighbouring Districts with low values of the type of crime.</p></li>
</ul>
<p>Users are to see if there are any significance with the LISA classification with the type of socio-economic factor.</p>
<p><img src="images/clipboard-2096302652.png" class="img-fluid"></p>
</section>
</section>
<section id="emerging-hot-spot-analysis" class="level3">
<h3 class="anchored" data-anchor-id="emerging-hot-spot-analysis">Emerging Hot Spot Analysis</h3>
<p>This tab allows users to run <a href="https://sfdep.josiahparry.com/articles/understanding-emerging-hotspots#using-emerging_hotspot_analysis"><code>emerging_hotspot_analysis()</code></a> on the type of crime. Users are able to select the type of crime to perform emerging hot spot analysis on, number of simulations to let it run and choosing the significance level which would affect the outputs on the right.</p>
<p>Users are able to see the hot spot classification on the map after running the analysis and the distribution of the classification on the bar graph below.</p>
<p>For the classification:</p>
<p>Credits to <a href="https://pro.arcgis.com/en/pro-app/latest/tool-reference/space-time-pattern-mining/learnmoreemerging.htm#GUID-09587AFC-F5EC-4AEB-BE8F-0E0A26AB9230" class="uri">https://pro.arcgis.com/en/pro-app/latest/tool-reference/space-time-pattern-mining/learnmoreemerging.htm#GUID-09587AFC-F5EC-4AEB-BE8F-0E0A26AB9230</a></p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Classification</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>No Pattern Detected</td>
<td>Does not fall into any of the hot or cold spot patterns defined below.</td>
</tr>
<tr class="even">
<td>New Hot Spot</td>
<td>A location that is a statistically significant hot spot for the final time step and has never been a statistically significant hot spot before.</td>
</tr>
<tr class="odd">
<td>Consecutive Hot Spot</td>
<td>A location with a single uninterrupted run of at least two statistically significant hot spot bins in the final time-step intervals. The location has never been a statistically significant hot spot prior to the final hot spot run and less than 90 percent of all bins are statistically significant hot spots.</td>
</tr>
<tr class="even">
<td>Intensifying Hot Spot</td>
<td>A location that has been a statistically significant hot spot for 90 percent of the time-step intervals, including the final time step. In addition, the intensity of clustering of high counts in each time step is increasing overall and that increase is statistically significant.</td>
</tr>
<tr class="odd">
<td>Persistent Hot Spot</td>
<td>A location that has been a statistically significant hot spot for 90 percent of the time-step intervals with no discernible trend in the intensity of clustering over time.</td>
</tr>
<tr class="even">
<td>Diminishing Hot Spot</td>
<td>A location that has been a statistically significant hot spot for 90 percent of the time-step intervals, including the final time step. In addition, the intensity of clustering in each time step is decreasing overall and that decrease is statistically significant.</td>
</tr>
<tr class="odd">
<td>Sporadic Hot Spot</td>
<td>A statistically significant hot spot for the final time-step interval with a history of also being an on-again and off-again hot spot. Less than 90 percent of the time-step intervals have been statistically significant hot spots and none of the time-step intervals have been statistically significant cold spots.</td>
</tr>
<tr class="even">
<td>Oscillating Hot Spot</td>
<td>A statistically significant hot spot for the final time-step interval that has a history of also being a statistically significant cold spot during a prior time step. Less than 90 percent of the time-step intervals have been statistically significant hot spots.</td>
</tr>
<tr class="odd">
<td>Historical Hot Spot</td>
<td>The most recent time period is not hot, but at least 90 percent of the time-step intervals have been statistically significant hot spots.</td>
</tr>
<tr class="even">
<td>New Cold Spot</td>
<td>A location that is a statistically significant cold spot for the final time step and has never been a statistically significant cold spot before.</td>
</tr>
<tr class="odd">
<td>Consecutive Cold Spot</td>
<td>A location with a single uninterrupted run of at least two statistically significant cold spot bins in the final time-step intervals. The location has never been a statistically significant cold spot prior to the final cold spot run and less than 90 percent of all bins are statistically significant cold spots.</td>
</tr>
<tr class="even">
<td>Intensifying Cold Spot</td>
<td>A location that has been a statistically significant cold spot for 90 percent of the time-step intervals, including the final time step. In addition, the intensity of clustering of low counts in each time step is increasing overall and that increase is statistically significant.</td>
</tr>
<tr class="odd">
<td>Persistent Cold Spot</td>
<td>A location that has been a statistically significant cold spot for 90 percent of the time-step intervals with no discernible trend in the intensity of clustering of counts over time.</td>
</tr>
<tr class="even">
<td>Diminishing Cold Spot</td>
<td>A location that has been a statistically significant cold spot for 90 percent of the time-step intervals, including the final time step. In addition, the intensity of clustering of low counts in each time step is decreasing overall and that decrease is statistically significant.</td>
</tr>
<tr class="odd">
<td>Sporadic Cold Spot</td>
<td>A statistically significant cold spot for the final time-step interval with a history of also being an on-again and off-again cold spot. Less than 90 percent of the time-step intervals have been statistically significant cold spots and none of the time-step intervals have been statistically significant hot spots.</td>
</tr>
<tr class="even">
<td>Oscillating Cold Spot</td>
<td>A statistically significant cold spot for the final time-step interval that has a history of also being a statistically significant hot spot during a prior time step. Less than 90 percent of the time-step intervals have been statistically significant cold spots.</td>
</tr>
<tr class="odd">
<td>Historical Cold Spot</td>
<td>The most recent time period is not cold, but at least 90 percent of the time-step intervals have been statistically significant cold spots.</td>
</tr>
</tbody>
</table>
<p><img src="images/clipboard-4264450265.png" class="img-fluid"></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>